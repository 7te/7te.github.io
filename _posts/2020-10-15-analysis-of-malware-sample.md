---
layout: post
title: "ABLETON_KEYGEN.exe malware analysis"
date: 2020-10-15 12:00:00 -0000
category: posts
author: 7te
tags: malware keygen.exe rootkit infosec
---

# sandboxing and analysing a piece of malware

using 
https://www.malwaretech.com/2017/11/creating-a-simple-free-malware-analysis-environment.html

## analysis sites

https://www.hybrid-analysis.com/sample/c7f7dd92f3b5694e5591d2e529c4070aa954b8b7c25b203664af33e8cb6ed176/5eea048f974ea50bf634a620

https://www.virustotal.com/gui/file/c7f7dd92f3b5694e5591d2e529c4070aa954b8b7c25b203664af33e8cb6ed176/behavior/SNDBOX

https://www.metadefender.com/#!/results/file/YnpJd01EWXhNSFJmZWtkUlNsUnBNemNnRGJlWFQ3QW04/regular


## associated domains
1e100.net
173.194.197.100:80


## registry
keygen.exe" (Path: "HKLM\SYSTEM\CONTROLSET001\CONTROL\TERMINAL SERVER"; Key: "TSUSERENABLED") 


## Classification (TrID)

    64.5% (.EXE) Win32 Executable MS Visual C++ (generic)
    13.6% (.DLL) Win32 Dynamic Link Library (generic)
    9.3% (.EXE) Win32 Executable (generic)
    4.1% (.EXE) OS/2 Executable (generic)
    4.1% (.EXE) Generic Win/DOS Executable


(img)[https://www.hybrid-analysis.com/file-inline/5eea048f974ea50bf634a620/main/visualized_sample.png]


## registry keys

```
\Registry\Machine\System\CurrentControlSet\Control\Session Manager
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\Windows\CurrentVersion\Explorer
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001_Classes
\Registry\Machine\System\CurrentControlSet\Control\Nls\Language Groups
\Registry\Machine\System\CurrentControlSet\Control\Nls\Locale\Alternate Sorts
\Registry\Machine\Software\Microsoft\Windows\Windows Error Reporting\WMR
\REGISTRY\MACHINE\Software\Policies\Microsoft\Cryptography
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\Windows\CurrentVersion\Policies\Explorer
\Registry\User\S-1-5-21-3616907901-860437140-2684471051-1001_Classes
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Control Panel\Desktop\LanguageConfiguration
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\DRIVERS32
\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Keyboard Layout\Toggle
\Registry\Machine\Software\Classes\CLSID\{20D04FE0-3AEA-1069-A2D8-08002B30309D}\ShellFolder
\Registry\Machine\Software\Microsoft\Windows NT\CurrentVersion\Image File Execution Options
\Registry\Machine\Software\Classes\CLSID\{CD773740-B187-4974-A1D5-E0FF91372277}
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\Windows\CurrentVersion\Explorer\Shell Folders
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Cryptography\Defaults\Provider\Microsoft Strong Cryptographic Provider
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\Image File Execution Options\(null)
\Registry\Machine\Software\Classes\Drive\shellex\FolderExtensions
\REGISTRY\MACHINE\Software\Microsoft\CTF\TIP\{0000897b-83df-4b96-be07-0fb58b01c4a4}\LanguageProfile\0x00000000\{0001bea3-ed56-483d-a2e2-aeae25577436}
\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Policies\NonEnum
\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion\Setup
\Registry\Machine\System\CurrentControlSet\Control\Nls\Sorting\Versions
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Capture\{b8f9cd9d-ac3d-4f75-957a-c974d982557e}
\REGISTRY\MACHINE\System\CurrentControlSet\Control\LSA\AccessProviders
\REGISTRY\MACHINE\System\CurrentControlSet\Services\LDAP
\REGISTRY\MACHINE\Software\Microsoft\Windows NT\CurrentVersion\ProfileList\S-1-5-21-3616907901-860437140-2684471051-1001
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Render\{85485174-325b-40a3-8cbb-73c66f5db55b}
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{B4BFCC3A-DB2C-424C-B029-7FE99A87C641}
\Registry\Machine\Software\Classes\CLSID\{1F486A52-3CB1-48FD-8F50-B8DC300D9F9D}
\REGISTRY\MACHINE\SOFTWARE\Microsoft\CTF\TIP\{3697C5FA-60DD-4B56-92D4-74A569205C16}\Category\Category\{534C48C1-0607-4098-A521-4FC899C73E90}
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\CTF\DirectSwitchHotkeys
\REGISTRY\MACHINE\SOFTWARE\Classes\CLSID\{1f486a52-3cb1-48fd-8f50-b8dc300d9f9d}\InprocServer32
\REGISTRY\MACHINE\System\Setup
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Control Panel\Desktop
\Registry\Machine\System\Setup
\REGISTRY\MACHINE\Software\Microsoft\OLE
\REGISTRY\MACHINE\Software\Microsoft\Cryptography
\Registry\Machine\Software\Policies\Microsoft\Windows\Safer\CodeIdentifiers
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{B4BFCC3A-DB2C-424C-B029-7FE99A87C641}\PropertyBag
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\LanguagePack\DataStore_V1.0
\Registry\Machine\Software\Microsoft\Windows NT\CurrentVersion\GRE_Initialize
\REGISTRY\MACHINE\Software\Microsoft\Windows NT\CurrentVersion\Windows
\REGISTRY\MACHINE\SOFTWARE\Classes\CLSID\{CD773740-B187-4974-A1D5-E0FF91372277}\InprocServer32
\Registry\MACHINE\System\CurrentControlSet\Control\Session Manager
\REGISTRY\MACHINE\Software\Microsoft\Rpc\Extensions
\REGISTRY\MACHINE\SOFTWARE\Microsoft\OLE
\REGISTRY\MACHINE\Software\Microsoft\COM3
\REGISTRY\MACHINE\SOFTWARE\Microsoft\CTF\TIP\
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Capture\{b8f9cd9d-ac3d-4f75-957a-c974d982557e}\Properties
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Control Panel\Desktop\MuiCached
\Registry\Machine\Software\Classes\Drive\shellex\FolderExtensions\{fbeb8a05-beee-4442-804e-409d6c4515e9}
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\Windows\CurrentVersion\Explorer\User Shell Folders
\Registry\Machine\System\CurrentControlSet\Control\Nls\Locale
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{1B3EA5DC-B587-4786-B4EF-BD1DC332AEAE}
\Registry\Machine\Software\Microsoft\SQMClient\Windows
\REGISTRY\MACHINE\SOFTWARE\Microsoft\CTF\TIP\{78CB5B0E-26ED-4FCC-854C-77E8F3D1AA80}\Category\Category\{534C48C1-0607-4098-A521-4FC899C73E90}
\Registry\Machine\System\CurrentControlSet\Control\Terminal Server
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\MMDevices\Audio\Render\{85485174-325b-40a3-8cbb-73c66f5db55b}\Properties
\REGISTRY\MACHINE\SOFTWARE\Microsoft\CTF\
\Registry\Machine\System\CurrentControlSet\Control\Lsa\FipsAlgorithmPolicy
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\FontLink\SystemLink
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\Windows NT\CurrentVersion\AppCompatFlags\Layers
\REGISTRY\MACHINE
\Registry\Machine\System\CurrentControlSet\Control\ComputerName\ActiveComputerName
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{3EB685DB-65F9-4CF6-A03A-E3EF65729F3D}
\REGISTRY\MACHINE\Software\Microsoft\Windows\CurrentVersion
\REGISTRY\MACHINE\System\CurrentControlSet\Control\SQMServiceList
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\Windows\CurrentVersion\Explorer\SessionInfo\1
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\System\CurrentControlSet\Control\MediaProperties\PrivateProperties\Joystick\Winmm
\REGISTRY\MACHINE\Software\Microsoft\Rpc
\Registry\Machine\System\CurrentControlSet\Control\Lsa
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2\CPC\Volume
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows NT\CurrentVersion\LanguagePack\SurrogateFallback
\Registry\Machine\System\CurrentControlSet\Control\Nls\CustomLocale
\REGISTRY\MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\{5E6C858F-0E22-4760-9AFE-EA3317B67173}
\REGISTRY\USER\S-1-5-21-3616907901-860437140-2684471051-1001\Software\Microsoft\Windows\CurrentVersion\Explorer\MountPoints2\CPC\Volume\{85c452dd-c2a7-11e9-ba50-806e6f6e6963}\
\Registry\Machine\System\CurrentControlSet\Control\Nls\ExtendedLocale
\Registry\MACHINE\Software\Microsoft\Windows\CurrentVersion\SideBySide
```